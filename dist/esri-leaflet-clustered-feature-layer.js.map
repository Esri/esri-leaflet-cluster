{"version":3,"sources":["src/ClusteredFeatureLayer.js"],"names":["exports","VERSION","ClusteredFeatureLayer","esri_leaflet","FeatureManager","extend","statics","EVENTS","CLUSTEREVENTS","initialize","options","prototype","call","this","L","setOptions","_layers","_leafletIds","cluster","markerClusterGroup","_key","Math","random","toString","replace","addEventParent","onAdd","map","_map","addLayer","onRemove","removeLayer","createLayers","features","markers","i","length","geojson","layer","id","newLayer","GeoJSON","geometryToLayer","feature","asFeature","defaultOptions","_leaflet_id","resetStyle","_popup","bindPopup","onEachFeature","fire","timeField","_featureWithinTimeRange","push","addLayers","ids","layersToAdd","removeLayers","permanent","layersToRemove","setFeatureStyle","style","setStyle","eachFeature","fn","popupContent","unbindPopup","context","getFeature","clusteredFeatureLayer","_ClusteredFeatureLayer"],"mappings":"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","file":"esri-leaflet-clustered-feature-layer.js","sourcesContent":["export var VERSION = '2.0.0-beta.1';\n\nimport L from 'leaflet';\nimport { FeatureManager } from 'esri-leaflet';\n\nexport var ClusteredFeatureLayer = FeatureManager.extend({\n\n  statics: {\n    EVENTS: 'click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose',\n    CLUSTEREVENTS: 'clusterclick clusterdblclick clustermouseover clustermouseout clustermousemove clustercontextmenu'\n  },\n\n  /**\n   * Constructor\n   */\n\n  initialize: function (options) {\n    FeatureManager.prototype.initialize.call(this, options);\n\n    options = L.setOptions(this, options);\n\n    this._layers = {};\n    this._leafletIds = {};\n\n    this.cluster = L.markerClusterGroup(options);\n    this._key = 'c' + (Math.random() * 1e9).toString(36).replace('.', '_');\n\n    // @TODO enable at Leaflet 0.8\n    this.cluster.addEventParent(this);\n\n    // @TODO remove from Leaflet 0.8\n    // this.cluster.on(ClusteredFeatureLayer.EVENTS, this._propagateEvent, this);\n    // this.cluster.on(ClusteredFeatureLayer.CLUSTEREVENTS, this._propagateClusterEvent, this);\n  },\n\n  /**\n   * Layer Interface\n   */\n\n  onAdd: function (map) {\n    FeatureManager.prototype.onAdd.call(this, map);\n    this._map.addLayer(this.cluster);\n  },\n\n  onRemove: function (map) {\n    FeatureManager.prototype.onRemove.call(this, map);\n    this._map.removeLayer(this.cluster);\n  },\n\n  /**\n   * Feature Management Methods\n   */\n\n  createLayers: function (features) {\n    var markers = [];\n\n    for (var i = features.length - 1; i >= 0; i--) {\n      var geojson = features[i];\n      var layer = this._layers[geojson.id];\n\n      if (!layer) {\n        var newLayer = L.GeoJSON.geometryToLayer(geojson, this.options);\n        newLayer.feature = L.GeoJSON.asFeature(geojson);\n        newLayer.defaultOptions = newLayer.options;\n        newLayer._leaflet_id = this._key + '_' + geojson.id;\n\n        this.resetStyle(newLayer.feature.id);\n\n        // bind a popup if we have one\n        if (this._popup && newLayer.bindPopup) {\n          newLayer.bindPopup(this._popup(newLayer.feature, newLayer));\n        }\n\n        // cache the layer\n        this._layers[newLayer.feature.id] = newLayer;\n\n        this._leafletIds[newLayer._leaflet_id] = geojson.id;\n\n        if (this.options.onEachFeature) {\n          this.options.onEachFeature(newLayer.feature, newLayer);\n        }\n\n        this.fire('createfeature', {\n          feature: newLayer.feature\n        });\n\n        // add the layer if it is within the time bounds or our layer is not time enabled\n        if (!this.options.timeField || (this.options.timeField && this._featureWithinTimeRange(geojson))) {\n          markers.push(newLayer);\n        }\n      }\n    }\n\n    if (markers.length) {\n      this.cluster.addLayers(markers);\n    }\n  },\n\n  addLayers: function (ids) {\n    var layersToAdd = [];\n    for (var i = ids.length - 1; i >= 0; i--) {\n      var layer = this._layers[ids[i]];\n      this.fire('addfeature', {\n        feature: layer.feature\n      });\n      layersToAdd.push(layer);\n    }\n    this.cluster.addLayers(layersToAdd);\n  },\n\n  removeLayers: function (ids, permanent) {\n    var layersToRemove = [];\n    for (var i = ids.length - 1; i >= 0; i--) {\n      var id = ids[i];\n      var layer = this._layers[id];\n      this.fire('removefeature', {\n        feature: layer.feature,\n        permanent: permanent\n      });\n      layersToRemove.push(layer);\n      if (this._layers[id] && permanent) {\n        delete this._layers[id];\n      }\n    }\n    this.cluster.removeLayers(layersToRemove);\n  },\n\n  /**\n   * Styling Methods\n   */\n\n  resetStyle: function (id) {\n    var layer = this._layers[id];\n\n    if (layer) {\n      layer.options = layer.defaultOptions;\n      this.setFeatureStyle(layer.feature.id, this.options.style);\n    }\n\n    return this;\n  },\n\n  setStyle: function (style) {\n    this.eachFeature(function (layer) {\n      this.setFeatureStyle(layer.feature.id, style);\n    }, this);\n    return this;\n  },\n\n  setFeatureStyle: function (id, style) {\n    var layer = this._layers[id];\n\n    if (typeof style === 'function') {\n      style = style(layer.feature);\n    }\n    if (layer.setStyle) {\n      layer.setStyle(style);\n    }\n  },\n\n  /**\n   * Popup Methods\n   */\n\n  bindPopup: function (fn, options) {\n    this._popup = fn;\n    for (var i in this._layers) {\n      var layer = this._layers[i];\n      var popupContent = this._popup(layer.feature, layer);\n      layer.bindPopup(popupContent, options);\n    }\n  },\n\n  unbindPopup: function () {\n    this._popup = false;\n    for (var i in this._layers) {\n      this._layers[i].unbindPopup();\n    }\n  },\n\n  /**\n   * Utility Methods\n   */\n\n  eachFeature: function (fn, context) {\n    for (var i in this._layers) {\n      fn.call(context, this._layers[i]);\n    }\n    return this;\n  },\n\n  getFeature: function (id) {\n    return this._layers[id];\n  }\n\n  // from https://github.com/Leaflet/Leaflet/blob/v0.7.2/src/layer/FeatureGroup.js\n  //  @TODO remove at Leaflet 0.8\n  // _propagateEvent: function (e) {\n  //   e = L.extend({\n  //     layer: this._layers[this._leafletIds[e.target._leaflet_id]],\n  //     target: this\n  //   }, e);\n  //   this.fire(e.type, e);\n  // },\n\n  // _propagateClusterEvent: function (e) {\n  //   e = L.extend({\n  //     layer: e.target,\n  //     target: this\n  //   }, e);\n  //   this.fire(e.type, e);\n  // }\n\n});\n\nexport function clusteredFeatureLayer (options) {\n  return new ClusteredFeatureLayer(options);\n}\n\nexport default clusteredFeatureLayer;\n"]}